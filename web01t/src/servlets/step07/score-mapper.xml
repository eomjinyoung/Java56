<?xml version="1.0" encoding="UTF-8"?>
<!-- 타입 별명 사용하기 + result map 사용하기 -->
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="servlets.step07.ScoreDao">
  <!-- 컬럼과 VO 객체의 프로퍼티를 연결하는 정보 설정 
  => 개발자는 프로퍼티 이름과 일치시키기 위해 컬럼의 별명을 선언할 필요가 없다.
  -->
  <resultMap type="score" id="scoreMap">
    <id column="sno" property="no"/>
    <result column="name" property="name"/>
    <result column="kor" property="kor"/>
    <result column="eng" property="eng"/>
    <result column="math" property="math"/>
  </resultMap>
  
  <!-- SQL문의 일부를 별도로 정의해 두고 필요할 때 포함시킨다. -->
  <sql id="scoreSelect">
    select sno, name, kor, eng, math 
    from scores 
  </sql>
  
  <!--  
  <select id="list" parameterType="map" resultType="score">
  -->
  <select id="list" parameterType="map" resultMap="scoreMap">
    <include refid="scoreSelect"/>
    order by sno desc
    limit #{pageStartIndex}, #{pageSize}
  </select>
  
  <select id="countAll" resultType="int">
    select count(sno) from scores 
  </select>
  
  <select id="selectOne" parameterType="int" resultMap="scoreMap">
    <include refid="scoreSelect"/>
    where sno=#{value} 
  </select>
  
  <insert id="insert" parameterType="score"
      useGeneratedKeys="true" keyColumn="sno" keyProperty="no">
    insert into scores (name, kor, eng, math)
    values(#{name}, #{kor}, #{eng}, #{math})
  </insert>
  
  <delete id="delete" parameterType="int">
    delete from scores where sno=#{okok}
  </delete>
  
  <update id="update" parameterType="score">
    update scores set 
      name=#{name}, kor=#{kor}, eng=#{eng}, math=#{math} 
    where sno=#{no}
  </update>    
</mapper>











